<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>

<head>
    <meta content="text/html;charset=ISO-8859-1" http-equiv="Content-Type">
    <title>A64 ISA XML for Armv8.7 (2020-12)</title>
</head>

<body>

    <div style="text-align: center;">
        <h1 style="text-decoration: underline;">A64 ISA XML for Armv8.7</h1>
        <h1 style="text-decoration: underline;">(2020-12)</h1>
        <h1 style="text-decoration: underline;">18 December 2020</h1>
    </div>


    <h2>1. Introduction</h2>

    <p>
        This is the <span style="font-style: italic;">2020-12</span>
        release of the A64 ISA XML for Armv8.7.
    </p>

    <p>
        The <a href="ISA_A64_xml_v87A-2020-12/xhtml/notice.html">Proprietary Notice</a>
        gives details of the terms and conditions under which this package
        is provided.
    </p>

    <p>
        If you have comments on the content of this package, please send
        them by e-mail to
        <a href="mailto:support-aarchv8@arm.com">support-aarchv8@arm.com</a>.
        Give:
    <ul>
        <li>The title, "A64 ISA XML for Armv8.7".</li>
        <li>The version, "2020-12".</li>
        <li>A concise explanation of your comments.</li>
    </ul>
    </p>
    <h3>Progressive Terminology Commitment</h3>
    <p>Arm values inclusive communities. Arm recognizes that we and our industry have used terms that can be offensive.
        Arm strives
        to lead the industry and create change.</p>
    <p>Previous issues of this document included terms that can be offensive. We have replaced these terms. If you find
        offensive terms
        in this document, please contact terms@arm.com.</p>
    <!--
<p>
  Additional documentation on the XML structure and Armv8's extensions
  to the pseudocode language are provided separately
  in <a href="ISA_xml_v2_readme.html">this readme file</a>.
</p>
-->

    <br />


    <h2>2. Contents</h2>

    <table style="width: 80%; background-color: rgb(223, 223, 224);" border="1" cellpadding="0" cellspacing="0">
        <tbody>
            <tr>
                <td rowspan="2">This Version</td>
                <td>2020-12</td>
                <td>&nbsp;<a href="ISA_A64_xml_v87A-2020-12/xhtml/index.html">[HTML]</a> </td>
                <td>&nbsp;<a href="ISA_A64_xml_v87A-2020-12.pdf">[PDF]</a> </td>
                <td>&nbsp;<a href="ISA_A64_xml_v87A-2020-12/index.xml">[XML]</a> </td>
            </tr>
            <tr>
                <td>with optimized pseudocode</td>
                <td>&nbsp;<a href="ISA_A64_xml_v87A-2020-12_OPT/xhtml/index.html">[HTML]</a> </td>
                <td>&nbsp;<a href="ISA_A64_xml_v87A-2020-12_OPT.pdf">[PDF]</a> </td>
                <td>&nbsp;<a href="ISA_A64_xml_v87A-2020-12_OPT/index.xml">[XML]</a> </td>
            </tr>
            <tr>
                <td rowspan="2">Change Markups</td>
                <td>2020-12 from 2020-09</td>
                <td>&nbsp;<a href="ISA_A64_xml_v87A-2020-12/from-ISA_A64_xml_v87A-2020-09/index.html">[HTML]</a> </td>
                <td>&nbsp;<a href="ISA_A64_xml_diff-v87A-2020-09-to-v87A-2020-12.pdf">[PDF]</a> </td>
            </tr>
            <tr>
                <td>optimized from non-optimized</td>
                <td>&nbsp;<a href="ISA_A64_xml_v87A-2020-12_OPT/from-ISA_A64_xml_v87A-2020-12/index.html">[HTML]</a>
                </td>
                <td>&nbsp;<a href="ISA_A64_xml_v87A-2020-12_OPT_diff.pdf">[PDF]</a> </td>
            </tr>
            <tr>
                <td>Previous Version</td>
                <td>2020-09</td>
                <td>&nbsp;<a href="ISA_A64_xml_v87A-2020-09/xhtml/index.html">[HTML]</a> </td>
            </tr>
        </tbody>
    </table>

    <br />


    <h2>3. Release Notes</h2>

    <h3>Change history</h3>

    <p>
        The following general changes are made:
    </p>

    <ul>
        <li>
            <!--17346-->
            The following features are added to the MPAM system architecture: Error MSI, Monitor Overflow MSI, and
            Monitor Overflow Status.
        </li>
        <li>
            <!--16451-->
            The optimized pseudocode for the double-precision variants of the FADDP, FMAXNMP,
            FMAXP, FMINNMP, and FMINP instructions is corrected to add missing checks.
        </li>
        <li>
            <!-- 16906 -->
            The FEAT_MTE feature is split into FEAT_MTE, Instruction only,
            and FEAT_MTE2, Full MTE, features.
        </li>
        <li>
            <!-- 17130 -->
            The STGP operational pseudocode is updated to check access is
            aligned to a tag granule.
        </li>
        <li>
            <!--17166-->
            The execute code for CSEL, CSINC, CSINV, CSNEG, CCMP, and CCMN is updated to create a dependency only via
            the register which is selected, not both of its input registers.
        </li>
        <li>
            <!--17374-->
            The ST64BV0 operational pseudocode is updated to correctly store the content of ACCDATA_EL1 in case of a Big
            Endian access.
        </li>
    </ul>
    <p>
        The following changes are made to the instruction definitions:
    </p>
    <ul>
        <li>
            None.
        </li>
    </ul>
    <p>
        The following changes are made to the Shared Pseudocode:
    </p>

    <ul>
        <li>
            <!--14613-->
            Removed unused function ReservedValue().
        </li>
        <li>
            <!--14760-->
            The decoding of Load/Store Multiple instructions inside FirstStageTranslation is replaced by a new memory
            accessor type AccType_ATOMICSTREAM.
        </li>
        <li>
            <!--16276-->
            Removed unused function UnallocatedEncoding().
        </li>
        <li>
            <!--16409-->
            Permission checks for Data/Instruction cache maintenance instructions corrected.
        </li>
        <li>
            <!--16792-->
            The pseudocode function AArch64.ExceptionReturn() moves the call to SynchroniseContext() following the
            checks for error synchronization.
        </li>
        <li>
            <!--16889-->
            The pseudocode functions AArch64.SecondStageTranslate() and AArch32.SecondStageTranslate() are updated to
            not generate an alignment fault to a memory location marked as Device for stage 2 for stage 1 walks.
        </li>
        <li>
            <!-- 16889 -->
            The pseudocode function AArch64.SecondStageTranslate() and
            AArch64.SecondStageTranslate() is updated to not generate an
            alignment fault to a memory location marked as Device for stage
            2 for stage 1 walks.
        </li>
        <li>
            <!--16989 -->
            The pseudocode function ProfilingBufferOwner() is updated to
            account for Secure EL2.
        </li>
        <li>
            <!-- 17036 -->
            The pseudocode function AArch64.WatchpointMatch() is updated to
            check for check for the atomic Read-Write memory access with the
            DBGWCR.LSC configuration.
        </li>
        <li>
            <!--17045-->
            The pseudocode function CollectTimeStamp() is adjusted to include the missing reserved value checks.
        </li>
        <li>
            <!-- 17075 -->
            The pseudocode function CombineS1S2AttrHints() is corrected to
            take into account Device memory when S2FWB is enabled.
        </li>
        <li>
            <!-- 17128 -->
            The pseudocode function AArch64.SoftwareStepException() is
            updated to include the IFSC of Debug Exception.
        </li>
        <li>
            <!-- 17169 -->
            The pseudocode functions AArch64.CheckPermission() and
            AArch32.CheckPermission() are updated to initialise priv_xn
            and user_xn prior to PAN checks that re determines the value of
            priv_w.
        </li>
        <li>
            <!-- 17184 -->
            The STGP pre-index and post-index decode pseudocode is updated
            to check for the presence of FEAT_MTE.
        </li>
        <li>
            <!-- 17200 -->
            The pseudocode function TraceTimeStamp() is updated to not treat
            the value '10' for TRFCR_EL1.TS and TRFCR_EL2.TS as UNPREDICTABLE
            in all cases.
        </li>
        <li>
            <!-- 17216 -->
            In pseudocode function AArch64.CheckWatchpoint() WnR bit to be
            set as 'read' in Atomic read-write operations if DBGWCR.LSC has
            a match on read.
        </li>
        <li>
            <!--17239-->
            The FEAT_MTE feature has been split into FEAT_MTE, Instruction only, and FEAT_MTE2, Full MTE. The pseudocode
            is updated accordingly for A64 base instructions and functions to use HaveMTE2Ext() instead of HaveMTEExt().
        </li>
        <li>
            <!-- 17247 -->
            The pseudocode function IsSErrorEdgeTriggered() takes a new
            parameter indicating the target Exception level. This function
            now checks the Execution state of the target Exception level to
            determine the correct syndrome checks. In AArch64 state syndrome<24>
                is now checked to establish if the SError is IMPLEMENTATION DEFINED.
        </li>
        <li>
            <!-- 17282 -->
            The decode pseudocode for SUBP(S) and STG pre-index/post-index MTE
            instructions is updated to check for the presence of FEAT_MTE.
        </li>
        <li>
            <!--17339-->
            The pseudocode functions AArch64.FirstStageTranslate() and AArch64.SecondStageTranslate() are updated with a
            check for data abort when the memory attribute of the data location accessed is not one of Normal Inner
            Non-cacheable Outer Non-cacheable, Device-GRE, Device-nGRE, Device-nGnRE, Device-nGnRnE.
        </li>
        <li>
            <!-- 17347 -->
            The access type AccType_DC_UNPRIV is now qualified with PSTATE.EL
            and AccType_DC. DC_UNPRIV usage is removed from the pseudocode.
        </li>
        <li>
            <!--17355-->
            The pseudocode function AArch64.WFxTrap() now correctly updates the Instruction Specific Syndrome if
            execution of WFET or WFIT is trapped.
        </li>
        <li>
            <!--17373-->
            The pseudocode function AArch64.FaultSyndrome() now correctly sets the Load/Store Type field within the ISS
            when an LD64B, ST64B, ST64BV, or ST64BV0 instruction generates a Data Abort for a Translation fault, Access
            flag fault, or Permission fault. AArch64.ExclusiveFault() takes two additional boolean parameters:
            secondstage and s1fs1walk.
        </li>
        <li>
            <!--17388-->
            Enumeration literal Unpredictable_PMUEventCount is added for Constrained Unpredictable access to Performance
            Monitor Event Count register access.
        </li>
        <li>
            <!--17389-->
            Enumeration literal Unpredictable_IGNORETRAPINDEBUG is added for register access trap ignore in Debug state.
        </li>
        <li>
            <!--17391-->
            The pseudocode functions CheckLDST64BEnabled(), CheckST64BVEnabled(), and CheckST64BV0Enabled() now check if
            the bits in HCRX_EL2 behave as 0 for indirect reads.
        </li>
        <li>
            The pseudocode for FEAT_XS is partially included in this release, including the addition of the pseudocode
            for the Arch64 DSBnXS instruction and the updates related to FEAT_XS in the DSB instructions.
        </li>
    </ul>

    <h3>Known issues</h3>

    <ul>
        <li>
            <!-- 13919 -->
            Clarification required to MRS/MSR instruction behavior with the SYS
            instruction following relaxation.
        </li>
        <li>
            <!-- 17052 -->
            The description of DSB encoding when FEAT_SSBS implemented will be
            clarified by making SSBB and PSSBB architectural aliases of DSB,
            and point to SSBB when CRm is 0b0000, and PSSBB when CRm is 0b0100.
        </li>
        <li>
            The pseudocode for FEAT_LPA2 is not available in this release.
        </li>
        <li>
            The pseudocode for FEAT_XS is not available in full. Effect of FEAT_XS on memory attributes and on A32 TLBI
            instructions is not present.
        </li>
        <li>
            In the browsable XML, hyperlinking with some pseudocode functions do not link correctly.
        </li>
        <li>
            Some architectural features have limited or no descriptions in pseudocode and are not fully covered by
            the functional testing. Affected features are listed below:
            <ul>
                <li>Address translation system instructions.</li>
                <li>Ordering of memory accesses.</li>
                <li>Self-hosted debug and behavior of PE when in Debug state.</li>
                <li>Trace architecture, including self-hosted trace and external trace.</li>
                <li>RAS architecture.</li>
                <li>Statistical Profiling Extension.</li>
                <li>Performance Monitors Extension.</li>
                <li>Activity Monitors Extension.</li>
                <li>Generic Timers.</li>
                <li>Generic Interrupt Controller.</li>
                <li>Multi-processing.</li>
            </ul>
        </li>
        <li>
            <!-- 16344-->
            The LDP, LDNP and STP instruction pseudocode does not show single-copy atomicity for 16 byte accesses, if
            the overall memory access is aligned to 16 bytes, or for access fewer than 16 bytes, where all accessed
            bytes are within a single 16-byte quantity aligned to 16 bytes, to Normal Inner-WB, Outer-WB Cacheable
            memory.
        </li>
    </ul>


    <br />


    <h3>Potential upcoming changes</h3>

    <ul>
        <li>The Shared pseudocode for VMSA will be refactored.</li>
        <li>The pseudocode for FEAT_XS and FEAT_LPA2 will be added.</li>
        <li>The pseudocode for system instructions will be added.</li>
    </ul>
</body>

</html>